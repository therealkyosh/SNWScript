local player = game.Players.LocalPlayer
local sg = player:WaitForChild("PlayerGui")
local StarterGui = game:GetService("StarterGui")

if sg:FindFirstChild("RemovedGuardsGui") then
    StarterGui:SetCore("SendNotification", {
        Title = "SNW",
        Text = "Script Already Executed\nUse /e destroy",
        Duration = 8,
        Icon = "rbxassetid://7072718362"
    })
    return
end

local gui = Instance.new("ScreenGui")
gui.Name = "RemovedGuardsGui"
gui.ResetOnSpawn = false
gui.Parent = sg

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 180, 0, 74)
mainFrame.Position = UDim2.new(0.5, -90, 0.12, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 18)
mainFrame.BackgroundTransparency = 0
mainFrame.BorderSizePixel = 0
mainFrame.Parent = gui

local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 6)
uiCorner.Parent = mainFrame

local uiStroke = Instance.new("UIStroke")
uiStroke.Color = Color3.fromRGB(0, 120, 255)
uiStroke.Thickness = 2
uiStroke.Transparency = 0.2
uiStroke.Parent = mainFrame

local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 28)
titleBar.BackgroundColor3 = Color3.fromRGB(28, 28, 32)
titleBar.BackgroundTransparency = 0
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 6)
titleCorner.Parent = titleBar

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, -36, 1, 0)
titleLabel.Position = UDim2.new(0, 8, 0, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "SNW | SFB"
titleLabel.TextColor3 = Color3.fromRGB(190, 190, 210)
titleLabel.TextSize = 15
titleLabel.Font = Enum.Font.SourceSansSemibold
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Parent = titleBar

local toggleCollapse = Instance.new("TextButton")
toggleCollapse.Size = UDim2.new(0, 24, 0, 24)
toggleCollapse.Position = UDim2.new(1, -30, 0, 2)
toggleCollapse.BackgroundTransparency = 1
toggleCollapse.Text = "–"
toggleCollapse.TextColor3 = Color3.fromRGB(160, 160, 180)
toggleCollapse.TextSize = 18
toggleCollapse.Font = Enum.Font.SourceSansBold
toggleCollapse.Parent = titleBar

local actionButton = Instance.new("TextButton")
actionButton.Size = UDim2.new(0.92, 0, 0, 32)
actionButton.Position = UDim2.new(0.04, 0, 0, 36)
actionButton.BackgroundColor3 = Color3.fromRGB(45, 45, 50)
actionButton.BackgroundTransparency = 0
actionButton.BorderSizePixel = 0
actionButton.Text = "Remove Guards"
actionButton.TextColor3 = Color3.fromRGB(220, 220, 230)
actionButton.TextSize = 15
actionButton.Font = Enum.Font.SourceSansSemibold
actionButton.Parent = mainFrame

local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(0, 6)
btnCorner.Parent = actionButton

local UIS = game:GetService("UserInputService")
local dragging, dragStart, startPos

titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

titleBar.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

local expanded = true

toggleCollapse.MouseButton1Click:Connect(function()
    expanded = not expanded
    if expanded then
        mainFrame.Size = UDim2.new(0, 180, 0, 74)
        actionButton.Visible = true
        toggleCollapse.Text = "–"
    else
        mainFrame.Size = UDim2.new(0, 180, 0, 28)
        actionButton.Visible = false
        toggleCollapse.Text = "+"
    end
end)

local connection

local function startProtection()
    if connection then return end
    
    local bases = workspace:FindFirstChild("Brainrot Bases")
    if not bases then
        warn("[RemovedGuards] Brainrot Bases not found")
        return
    end
    
    connection = bases.DescendantAdded:Connect(function(desc)
        if desc.Name == "Killer" and desc:IsA("Folder") then
            task.defer(desc.Destroy, desc)
        end
    end)
    
    for _, obj in ipairs(bases:GetDescendants()) do
        if obj.Name == "Killer" and obj:IsA("Folder") then
            obj:Destroy()
        end
    end
end

actionButton.MouseButton1Click:Connect(function()
    startProtection()
    
    local oldColor = actionButton.BackgroundColor3
    actionButton.BackgroundColor3 = Color3.fromRGB(0, 90, 200)
    task.wait(0.12)
    actionButton.BackgroundColor3 = oldColor
    
    StarterGui:SetCore("SendNotification", {
        Title = "SNW",
        Text = "Removed Guards",
        Duration = 5,
        Icon = "rbxassetid://7072721035"
    })
end)

player.Chatted:Connect(function(msg)
    if msg:lower() == "/e destroy" then
        if gui and gui.Parent then
            gui:Destroy()
        end
    end
end)
